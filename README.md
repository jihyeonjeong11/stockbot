부르는 순서(중요! 크론탭에서)

KIS_MakeToken 하루에 두번

KIS_MakeStockCodeList 하루에 한번 (새벽)

KIS_Make_StockData_KR 하루에 한번(새벽 가장 오래걸림)

SmallStock_ST_KR 한달에 한번

나중에 /var/autobot은 전부 ./으로 바꿔주자 그냥

////////////////////////////////////////////////////////////////////////////////

2.2 파일토큰 저장 시스템 02/19

몇가지 종목만 거래하고 싶을때, 이 토큰들을 저장하는 과정.
KIS_Common.py에 token을 한국투자증권에 보내서 받아오는 과정을 진행함.

////////////////////////////////////////////////////////////////////////////////

2.3 국내주식 헬퍼

test.py에 삼성 두주 구매 한주 판매 나와있음.

평일에 체크해보자.

////////////////////////////////////////////////////////////////////////////////

2.4 해외주식 헬퍼 02/20

테스트해보고 또 적을거임.

통합증거금이란?? 원화로 미국 주식 살 수 있는 제도.

굳이 필요할까? 환전하는게 나을듯

////////////////////////////////////////////////////////////////////////////////

2.5 캔들정보 읽ㅣ

GetOhlcv kr과 us를 본다.

open, high, low, close, volume이 캔들의 값임

여기에 value 거래대금, change 등락률까지 추가됨,

https://apiportal.koreainvestment.com/apiservice/apiservice-domestic-stock-quotations#L_a08c3421-e50f-4f24-b1fe-64c12f723c77

////////////////////////////////////////////////////////////////////////////////

5.1 퀀트 기본 02/21

일단 3,4 내용은 나중에 하도록 한다.
원래 만드려던것은 봇 퀀트 자동매매이기때문에, 다른건 나중에 보기로 함.

퀀트. 다른건 신경쓰지 않고, 오로지 수치만으로 판별해서 사고 판다.
여기 내용은 더욱 자세하기 때문에, 이 부분 기초를 끝내면, 여기 강의에서 다른걸 하던지, 아니면 퀀트 관련 더 공부를 해서 작업하는게 맞음.

퀀트의 개념은 다음과 같다.
우량주보다, 수치가 좋은 소형주가 훨씬 수익률이 높을 수 있다.

https://www.youtube.com/watch?v=-yB4zzU14-0&t=1906s

31분 36초부터 보고 온다. 오늘 집에가서 보기

https://blog.naver.com/zacra/223000628375 이것도보기

조건: 시총 50억 이상, 영업이익 0 이상(플러스)

작은거 순으로 정렬 후
가장 작은거부터 20개 분산 투자

종목 당 최대 매수 금액은 500만원

MDD(Maximum Draw Down)란? · 일정기간 동안 최고점과 최저점을 비율로 계산한 값 · MDD값이 높다 = 주식 가격이 위아래로 출렁이며 파도친다

연복리 수익: 35% (원금대비 10000% 수익)
MDD: -45%

마켓타이밍을 가미하면?

코스닥 소형지수 20일 이평선 위에 있으면 보유
20일 이평선 밑에 있으면 매도

연복리 수익: 40% 원금대비 13000% 수익 술리피지나 여러 상황 감안하면 30%로 보는게 합리적
mdd: -15%

다음강의에는 이렇게 가져온 리스트와 재무재표를 비교하는 로직 작성예정

////////////////////////////////////////////////////////////////////////////////

5.2 퀀트 주가총액 가져오기 02/23

퀀트투자를 위한 조건(매수조건 매도조건)을 받아오는 정보를 작성한다

https://apiportal.koreainvestment.com/apiservice/apiservice-domestic-stock-quotations#L_07802512-4f49-4486-91b4-1050b6f5dc9d

현재가 시세 endpoint 주소

필요한것.

시가총액
PER, PBR BPS 로 판단한다.

helper_KR에 GetCurrentStatus가 추가됨. 336줄

영업이익은 다음강의

MakeStockData_KR을 참고한다.

여기서는 종목상태가 00: 그외, 55: 신용가능, 57: 증거금100% 인것을 먼저 찾음(나머지는 매수 안함)

이게 돌아가는데는 1시간정도 걸린다고 함. crontab할때 참고

그리고 StockMarketCap이 50.0 이상 작은 순서부터 리턴
금융, 외국증권 카테고리는 뺌.

이후 시총순으로 정렬해서 리턴 20개

동영상 확인해서 크론탭 몇시에 있는지 확인 여기서는 오후 5에 돌렸다고 함.

////////////////////////////////////////////////////////////////////////////////

5.3 영업이익 크롤링 02/23

여기서는 시가총액 과 스테이터스로 거른 기업들을 다시 영업이익및 다른 값으로 추가로 걸러서 매수대상을 결정한다.

EPS 주당 순이익: 순이익을 그 기업의 총 주식수로 나눈 값
BPS 주당 순자산: 순자산(부채)를 그 기업의 총 주식수로 나눈 값

PER 현재가 / EPS: 현재가가 1주당 수익의 몇 배인가?
PBR 현재가 / BPS: 현재가가 1주당 순자산의 몇 배인가?

EPS가 큰 것이 중요하다.
영업이익보다 순이익이 더욱 엄격한 기준이기 때문이다.

test.py에

시총 50조 eps 양수인것으로 조건 걸려있음

크롤링 네이버 금융에서 가져오는 것으로. test.py 확인

smallStock_st에 실제 구현된 예제가 있음

실제 영업수준에서 다 걸러질 수도 있기 때문에,

하나씩 크롤링하는 수준으로 코드가 바뀌었음.

////////////////////////////////////////////////////////////////////////////////

5.4 위 데이터들로 실제 매매하기 02/26

먼저 자기 밸런스 호출, 가용한 돈이 얼마인지 확인하고

위 데이터들로 조건에 맞는 주들을 가져옴,(주가총액이 작은 순서대로)

이거에 맞게 한달에 한번,

조건에 맞으면 매수, 주가 작은 순서 20개에 퇴출되었다(주가가 올랐다) 면 매도한다.

이 과정을 리밸런싱 이라고 함.

////////////////////////////////////////////////////////////////////////////////

5.5 마켓타이밍 구현 2/26

이 경우 mdd가 높기 떄문에, 줄이는 방안을 추가한다.

코스닥 평균주 20도선을 기준으로 위에 있으면 유지, 아래 있으면 매도

SmallStock_ST_KR_MT 20000만원 구매함.

KrSmallStockMaCheck.json 새 파일 20도선 리스트 bool

#상태1 ST_FIRST : 처음 매수해야 되는 경우... 20일 이평선 위에 있으면 정상 진행..20일 이평선 아래에 있으면 아무 진행도 하지 않는다. IsNowMaUp 값이 True면 진행 아니면 진행 무! #상태2 ST_DOWN : 이전 IsPrevMaUp 이 True인데 IsNowMaUp이 False 라면 해당 전략으로 매수한 주식 모두 팔아야 되는 상황! - 이달의 리밸런싱 진행여부와 관계 없음 #상태3 ST_UP : 이전 IsPrevMaUp이 False인데 IsNowMaUp이 True 라면 해당 전략으로 주식을 다시 사야 되는 상황! - 이달의 리밸런싱 진행여부와 관계 없음 #상태4 NONE : 위 경우에 해당되지 않는 경우

새로만든 파일 SmallStock_ST_MT
의 경우, MA20보다 현재가 아래면 동작하지 않는다.

매일 실행해야하지만, 따라서 처음 실행할때 KR로 사놓고, MT를 매일 돌리는 식으로 하면 될거같기도함

스크린샷 저장된걸로 크론탭 설정해놓기

////////////////////////////////////////////////////////////////////////////////
